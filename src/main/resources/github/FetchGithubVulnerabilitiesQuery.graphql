query (
  $orgName: String!
  $repoEndCursor: String
  $repoStartCursor: String
  $vulnEndCursor: String
) {
  organization(login: $orgName) {
    repositories(
      first: 30
      isArchived: false
      after: $repoEndCursor
      before: $repoStartCursor
      orderBy: { field: CREATED_AT, direction: ASC }
    ) {
      nodes {
        visibility
        name
        vulnerabilityAlerts(first: 100, after: $vulnEndCursor, states: OPEN) {
          nodes {
            dependencyScope
            dependabotUpdate {
              pullRequest {
                permalink
              }
            }
            securityAdvisory {
              publishedAt
              cvss {
                score
              }
              summary
              identifiers {
                type
                value
              }
            }
            securityVulnerability {
              severity
              package {
                ecosystem
                name
              }
            }
          }
          pageInfo {
            hasNextPage
            endCursor
          }
        }
      }
      pageInfo {
        hasNextPage
        endCursor
        startCursor
      }
    }
  }
}
